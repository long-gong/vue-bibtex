'use strict';

exports.__esModule = true;

exports.default = function (filePath) {
    const forbiddenCharsList = [];

    (0, _sanitizeFilename2.default)(filePath, {
        replacement: (chars, index) => addForbiddenCharsToList(forbiddenCharsList, { chars, index })
    });

    correctForbiddenCharsList(forbiddenCharsList, filePath);

    return forbiddenCharsList;
};

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _osFamily = require('os-family');

var _sanitizeFilename = require('sanitize-filename');

var _sanitizeFilename2 = _interopRequireDefault(_sanitizeFilename);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const SAFE_CHAR = '_';
const ALLOWED_CHARS_LIST = [_path2.default.win32.sep, _path2.default.posix.sep, '.', '..'];

function correctForbiddenCharsList(forbiddenCharsList, filePath) {
    const isWinAbsolutePath = _osFamily.win && _path2.default.isAbsolute(filePath);
    const hasDriveSeparatorInList = forbiddenCharsList.length && forbiddenCharsList[0].chars === ':' && forbiddenCharsList[0].index === 1;

    if (isWinAbsolutePath && hasDriveSeparatorInList) forbiddenCharsList.shift();
}

function addForbiddenCharsToList(forbiddenCharsList, forbiddenCharsInfo) {
    const chars = forbiddenCharsInfo.chars;


    if (!ALLOWED_CHARS_LIST.includes(chars)) forbiddenCharsList.push(forbiddenCharsInfo);

    return SAFE_CHAR.repeat(chars.length);
}

module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9jaGVjay1maWxlLXBhdGguanMiXSwibmFtZXMiOlsiZmlsZVBhdGgiLCJmb3JiaWRkZW5DaGFyc0xpc3QiLCJyZXBsYWNlbWVudCIsImNoYXJzIiwiaW5kZXgiLCJhZGRGb3JiaWRkZW5DaGFyc1RvTGlzdCIsImNvcnJlY3RGb3JiaWRkZW5DaGFyc0xpc3QiLCJTQUZFX0NIQVIiLCJBTExPV0VEX0NIQVJTX0xJU1QiLCJwYXRoIiwid2luMzIiLCJzZXAiLCJwb3NpeCIsImlzV2luQWJzb2x1dGVQYXRoIiwiaXNXaW4iLCJpc0Fic29sdXRlIiwiaGFzRHJpdmVTZXBhcmF0b3JJbkxpc3QiLCJsZW5ndGgiLCJzaGlmdCIsImZvcmJpZGRlbkNoYXJzSW5mbyIsImluY2x1ZGVzIiwicHVzaCIsInJlcGVhdCJdLCJtYXBwaW5ncyI6Ijs7OztrQkEwQmUsVUFBVUEsUUFBVixFQUFvQjtBQUMvQixVQUFNQyxxQkFBcUIsRUFBM0I7O0FBRUEsb0NBQWlCRCxRQUFqQixFQUEyQjtBQUN2QkUscUJBQWEsQ0FBQ0MsS0FBRCxFQUFRQyxLQUFSLEtBQWtCQyx3QkFBd0JKLGtCQUF4QixFQUE0QyxFQUFFRSxLQUFGLEVBQVNDLEtBQVQsRUFBNUM7QUFEUixLQUEzQjs7QUFJQUUsOEJBQTBCTCxrQkFBMUIsRUFBOENELFFBQTlDOztBQUVBLFdBQU9DLGtCQUFQO0FBQ0gsQzs7QUFwQ0Q7Ozs7QUFDQTs7QUFDQTs7Ozs7O0FBR0EsTUFBTU0sWUFBcUIsR0FBM0I7QUFDQSxNQUFNQyxxQkFBcUIsQ0FBQ0MsZUFBS0MsS0FBTCxDQUFXQyxHQUFaLEVBQWlCRixlQUFLRyxLQUFMLENBQVdELEdBQTVCLEVBQWlDLEdBQWpDLEVBQXNDLElBQXRDLENBQTNCOztBQUdBLFNBQVNMLHlCQUFULENBQW9DTCxrQkFBcEMsRUFBd0RELFFBQXhELEVBQWtFO0FBQzlELFVBQU1hLG9CQUEwQkMsaUJBQVNMLGVBQUtNLFVBQUwsQ0FBZ0JmLFFBQWhCLENBQXpDO0FBQ0EsVUFBTWdCLDBCQUEwQmYsbUJBQW1CZ0IsTUFBbkIsSUFBNkJoQixtQkFBbUIsQ0FBbkIsRUFBc0JFLEtBQXRCLEtBQWdDLEdBQTdELElBQW9FRixtQkFBbUIsQ0FBbkIsRUFBc0JHLEtBQXRCLEtBQWdDLENBQXBJOztBQUVBLFFBQUlTLHFCQUFxQkcsdUJBQXpCLEVBQ0lmLG1CQUFtQmlCLEtBQW5CO0FBQ1A7O0FBRUQsU0FBU2IsdUJBQVQsQ0FBa0NKLGtCQUFsQyxFQUFzRGtCLGtCQUF0RCxFQUEwRTtBQUFBLFVBQzlEaEIsS0FEOEQsR0FDcERnQixrQkFEb0QsQ0FDOURoQixLQUQ4RDs7O0FBR3RFLFFBQUksQ0FBQ0ssbUJBQW1CWSxRQUFuQixDQUE0QmpCLEtBQTVCLENBQUwsRUFDSUYsbUJBQW1Cb0IsSUFBbkIsQ0FBd0JGLGtCQUF4Qjs7QUFFSixXQUFPWixVQUFVZSxNQUFWLENBQWlCbkIsTUFBTWMsTUFBdkIsQ0FBUDtBQUNIIiwiZmlsZSI6InV0aWxzL2NoZWNrLWZpbGUtcGF0aC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgd2luIGFzIGlzV2luIH0gZnJvbSAnb3MtZmFtaWx5JztcbmltcG9ydCBzYW5pdGl6ZUZpbGVuYW1lIGZyb20gJ3Nhbml0aXplLWZpbGVuYW1lJztcblxuXG5jb25zdCBTQUZFX0NIQVIgICAgICAgICAgPSAnXyc7XG5jb25zdCBBTExPV0VEX0NIQVJTX0xJU1QgPSBbcGF0aC53aW4zMi5zZXAsIHBhdGgucG9zaXguc2VwLCAnLicsICcuLiddO1xuXG5cbmZ1bmN0aW9uIGNvcnJlY3RGb3JiaWRkZW5DaGFyc0xpc3QgKGZvcmJpZGRlbkNoYXJzTGlzdCwgZmlsZVBhdGgpIHtcbiAgICBjb25zdCBpc1dpbkFic29sdXRlUGF0aCAgICAgICA9IGlzV2luICYmIHBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCk7XG4gICAgY29uc3QgaGFzRHJpdmVTZXBhcmF0b3JJbkxpc3QgPSBmb3JiaWRkZW5DaGFyc0xpc3QubGVuZ3RoICYmIGZvcmJpZGRlbkNoYXJzTGlzdFswXS5jaGFycyA9PT0gJzonICYmIGZvcmJpZGRlbkNoYXJzTGlzdFswXS5pbmRleCA9PT0gMTtcblxuICAgIGlmIChpc1dpbkFic29sdXRlUGF0aCAmJiBoYXNEcml2ZVNlcGFyYXRvckluTGlzdClcbiAgICAgICAgZm9yYmlkZGVuQ2hhcnNMaXN0LnNoaWZ0KCk7XG59XG5cbmZ1bmN0aW9uIGFkZEZvcmJpZGRlbkNoYXJzVG9MaXN0IChmb3JiaWRkZW5DaGFyc0xpc3QsIGZvcmJpZGRlbkNoYXJzSW5mbykge1xuICAgIGNvbnN0IHsgY2hhcnMgfSA9IGZvcmJpZGRlbkNoYXJzSW5mbztcblxuICAgIGlmICghQUxMT1dFRF9DSEFSU19MSVNULmluY2x1ZGVzKGNoYXJzKSlcbiAgICAgICAgZm9yYmlkZGVuQ2hhcnNMaXN0LnB1c2goZm9yYmlkZGVuQ2hhcnNJbmZvKTtcblxuICAgIHJldHVybiBTQUZFX0NIQVIucmVwZWF0KGNoYXJzLmxlbmd0aCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIChmaWxlUGF0aCkge1xuICAgIGNvbnN0IGZvcmJpZGRlbkNoYXJzTGlzdCA9IFtdO1xuXG4gICAgc2FuaXRpemVGaWxlbmFtZShmaWxlUGF0aCwge1xuICAgICAgICByZXBsYWNlbWVudDogKGNoYXJzLCBpbmRleCkgPT4gYWRkRm9yYmlkZGVuQ2hhcnNUb0xpc3QoZm9yYmlkZGVuQ2hhcnNMaXN0LCB7IGNoYXJzLCBpbmRleCB9KVxuICAgIH0pO1xuXG4gICAgY29ycmVjdEZvcmJpZGRlbkNoYXJzTGlzdChmb3JiaWRkZW5DaGFyc0xpc3QsIGZpbGVQYXRoKTtcblxuICAgIHJldHVybiBmb3JiaWRkZW5DaGFyc0xpc3Q7XG59XG4iXX0=
